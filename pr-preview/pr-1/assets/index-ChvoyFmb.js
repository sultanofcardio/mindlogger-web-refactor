import{j as n,L as j}from"./index-BMwGXOHN.js";import{l as p,B as r,d as x,M as f,T as y,f as A,m as B}from"./LaunchDarklyProvider-3c5FlTCa.js";import{c as M,u as I,a as m,M as L,R as g,aQ as E,G as b,aR as C}from"./index-DoRMT53w.js";import{i as d,P as v,A as D}from"./index-BhhNTH8T.js";import{u,I as P}from"./Invitation-8tbQx8Mj.js";import"./signup.schema-DH0eMdIG.js";const S={hasBeenProccesed:"Invitation has been already processed.",doesNotExist:"Invitation does not exist."},R=(t,e)=>M(["invitationDetails",{invitationId:t}],()=>d.getInvitationById({invitationId:t}),e),T=t=>I(["acceptInvitation"],d.acceptInvitation,{...t}),k=t=>I(["declineInvitation"],d.declineInvitation,{...t}),Q=({error:t})=>{const{t:e}=u();return t.evaluatedMessage===S.hasBeenProccesed?n.jsx(v,{message:e("invitationAlreadyRemoved"),testid:"invitation-removed-message"}):n.jsx(v,{message:e("notAssociatedAccount"),testid:"invitation-not-associated-account-message"})},w=({invitationKey:t})=>{const{t:e}=u(),{navigate:i}=m(),{addSuccessBanner:a}=p(),{mutate:o,isLoading:s}=T({onSuccess(){return a(e("invitationAccepted")),f.track({action:L.InvitationAccepted}),i(g.appletList.path)}}),c=()=>o({invitationId:t});return n.jsx(r,{width:"250px",children:n.jsx(x,{type:"button",variant:"contained",color:"success",onClick:c,isLoading:s,text:e("buttons.acceptInvitation")})})},z=({invitationKey:t})=>{const{t:e}=u(),{navigate:i}=m(),{addErrorBanner:a}=p(),{mutate:o,isLoading:s}=k({onSuccess(){a(e("invitationDeclined")),i(g.appletList.path)}}),c=()=>{o({invitationId:t})};return n.jsx(r,{width:"250px",children:n.jsx(x,{type:"button",variant:"contained",color:"error",onClick:c,isLoading:s,text:e("buttons.declineInvitation")})})},G=({keyParams:t})=>{var l;const{t:e}=u(),{isAuthenticated:i}=E(),{lessThanSM:a}=b(),{isError:o,data:s,error:c,isLoading:h}=R(t);return o?n.jsx(Q,{error:c}):h?n.jsxs(r,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",textAlign:"center",children:[n.jsx(y,{variant:"body1",margin:"12px",children:e("loadingInvitation")}),n.jsx(j,{})]}):n.jsx(P,{invite:(l=s==null?void 0:s.data)==null?void 0:l.result,isUserAuthenticated:i,actionComponent:n.jsxs(r,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:a?"column":"row",gap:"12px",margin:"16px 0px",children:[n.jsx(w,{invitationKey:t}),n.jsx(z,{invitationKey:t})]})})};function q(){const{inviteId:t}=A(),e=B(),i={backRedirectPath:`${e.pathname}${e.search}`};return n.jsx(r,{display:"flex",flex:1,justifyContent:"center",alignItems:"center",margin:"24px",children:t&&n.jsx(C,{fallback:n.jsx(D,{redirectState:i}),children:n.jsx(G,{keyParams:t})})})}export{q as default};
